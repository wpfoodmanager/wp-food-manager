var WPFM_Frontend=function(){return{init:function(){jQuery(".food-manager-post_type-dropdown").length>0&&jQuery(".food-manager-post_type-dropdown").chosen({search_contains:!0}),jQuery(".food_manager_menu .food-list-box img").on("click",WPFM_Frontend.actions.openFoodMenuPopup),jQuery(".fm-food-menu-container .food-list-box img").on("click",WPFM_Frontend.actions.openFoodMenuPopup),jQuery(document).on("click",".wpfm-modal-close",(function(){jQuery(this).parents("#wpfm_food_popup").removeClass("wpfm-modal-open")})),jQuery(".wpfm-additional-main-row").length>0&&(jQuery(".wpfm-additional-main-row").hide(),jQuery(".wpfm-view-more").click((function(){jQuery(this).text("View less -"==jQuery(this).text()?"View more +":"View less -"),jQuery(this).parent().find(".wpfm-additional-main-row").slideToggle()})));try{jQuery(".wpfm-single-food-slider, .wpfm-img-multi-container").slick({dots:!0,infinite:!0,speed:500,adaptiveHeight:!0})}catch(e){}jQuery(".wpfm-form-group.fieldset-topping_description").hide(),jQuery("body").on("click","a.wpfm-food-item-remove",WPFM_Frontend.actions.removeFoodItem),jQuery("body").on("wpfm_add_error_tip",(function(e,t,o){var r=t.position();0===t.parent().find(".wpfm_error_tip").length&&(t.after('<div class="wpfm_error_tip '+o+'">'+wpfm_accounting_params[o]+"</div>"),t.parent().find(".wpfm_error_tip").css("left",r.left+t.width()-t.width()/2-jQuery(".wpfm_error_tip").width()/2).css("top",r.top+t.height()).fadeIn("100"))})),jQuery("body").on("wpfm_remove_error_tip",(function(e,t,o){t.parent().find(".wpfm_error_tip."+o).fadeOut("100",(function(){jQuery(this).remove()}))})),jQuery("body").on("click",(function(){jQuery(".wpfm_error_tip").fadeOut("100",(function(){jQuery(this).remove()}))})),jQuery("body").on("blur","#_food_sale_price",(function(){jQuery(".wpfm_error_tip").fadeOut("100",(function(){jQuery(this).remove()}))})),jQuery("body").on("keyup","#_food_sale_price",(function(e,t){var o,r=jQuery(this);o=jQuery("#_food_price"),parseFloat(window.accounting.unformat(r.val()))>=parseFloat(window.accounting.unformat(o.val()))?jQuery(document.body).triggerHandler("wpfm_add_error_tip",[jQuery(this),"wpfm_sale_less_than_regular_error"]):jQuery(document.body).triggerHandler("wpfm_remove_error_tip",[jQuery(this),"wpfm_sale_less_than_regular_error"])})),jQuery("body").on("change","#_food_sale_price",(function(){var e,t=jQuery(this);e=jQuery("#_food_price"),parseFloat(window.accounting.unformat(t.val()))>=parseFloat(window.accounting.unformat(e.val()))&&jQuery(this).val("")})),jQuery(document).on("click",".wpfm-add-row",WPFM_Frontend.actions.addElementRow),jQuery(document).on("click",".option-delete-btn",WPFM_Frontend.actions.removeAttributesOptions),jQuery(document).on("click",".wpfm-delete-btn",WPFM_Frontend.actions.removeAttributes),jQuery("#wpfm-add-new-option").on("click",WPFM_Frontend.actions.addNewOption),jQuery("body").on("change",'input[name^="topping_name"]',WPFM_Frontend.actions.updateOptionTitle),jQuery(document).on("click",".wpfm-togglediv",(function(e){var t=jQuery(this).data("row-count");"true"===jQuery(e.currentTarget).attr("aria-expanded")?(jQuery(".wpfm-options-wrap.wpfm-options-box-"+t).removeClass("closed"),jQuery(this).attr("aria-expanded","false")):(jQuery(".wpfm-options-wrap.wpfm-options-box-"+t).addClass("closed"),jQuery(this).attr("aria-expanded","true")),jQuery(this).parents(".postbox").find(".wpfm-options-box").slideToggle("slow")})),jQuery(".container .wpfm-form-wrapper table.widefat tbody").sortable({connectWith:".container .wpfm-form-wrapper table.widefat tbody",items:"tr",axis:"y",placeholder:"placeholder",opacity:.65,update:function(e,t){var o=jQuery(this).closest(".postbox").children(".repeated-options").val();jQuery(".container .wpfm-form-group.fieldset_topping_options_"+o+" table.widefat tbody tr").each((function(e){var t=e+1;jQuery(this).children("td:nth-child(2)").html(t),jQuery(this).attr("class","option-tr-"+t),jQuery(this).children(".option-value-class").val(t),jQuery(this).children("td").children(".opt_name").attr("name",o+"_option_name_"+t),jQuery(this).children("td").children(".opt_price").attr("name",o+"_option_price_"+t),jQuery(this).children("td").children(".option-delete-btn").attr("data-id",t)}))}}).disableSelection(),jQuery("body").on("wpfm_add_error_tip",(function(e,t,o){var r=t.position();0===t.parent().find(".wpfm_error_tip").length&&(t.after('<div class="wpfm_error_tip '+o+'">'+wpfm_accounting_params[o]+"</div>"),t.parent().find(".wpfm_error_tip").css("left",r.left+t.width()-t.width()/2-jQuery(".wpfm_error_tip").width()/2).css("top",r.top+t.height()).fadeIn("100"))})),jQuery("body").on("wpfm_remove_error_tip",(function(e,t,o){t.parent().find(".wpfm_error_tip."+o).fadeOut("100",(function(){jQuery(this).remove()}))})),jQuery("body").on("click",(function(){jQuery(".wpfm_error_tip").fadeOut("100",(function(){jQuery(this).remove()}))})),jQuery("body").on("blur","#food_sale_price",(function(){jQuery(".wpfm_error_tip").fadeOut("100",(function(){jQuery(this).remove()}))})),jQuery("body").on("keyup","#food_sale_price",(function(e,t){var o,r=jQuery(this);o=jQuery("#food_price"),parseFloat(window.accounting.unformat(r.val()))>=parseFloat(window.accounting.unformat(o.val()))?jQuery(document.body).triggerHandler("wpfm_add_error_tip",[jQuery(this),"wpfm_sale_less_than_regular_error"]):jQuery(document.body).triggerHandler("wpfm_remove_error_tip",[jQuery(this),"wpfm_sale_less_than_regular_error"])})),jQuery("body").on("change","#food_sale_price",(function(){var e,t=jQuery(this);e=jQuery("#food_price"),parseFloat(window.accounting.unformat(t.val()))>=parseFloat(window.accounting.unformat(e.val()))&&jQuery(this).val("")})),jQuery(".wpfm-accordion-action").click((function(e){jQuery(this).parent().hasClass("wpfm-accordion-item-show")?jQuery(this).parent().removeClass("wpfm-accordion-item-show"):(jQuery(".wpfm-accordion-item").removeClass("wpfm-accordion-item-show"),jQuery(this).parent().addClass("wpfm-accordion-item-show"))})),jQuery(".account-sign-in").length?jQuery("#link-modal-title").length&&jQuery("#link-modal-title").replaceWith((function(){return jQuery("<h2>",{html:jQuery(this).html()}).css({background:"#fff","border-bottom":"1px solid #dcdcde","font-size":"18px","font-weight":"600","line-height":"2",margin:"0",padding:"0 36px 0 16px"})})):jQuery("#wp-link-wrap").remove(),jQuery(".food-menu-page-filter-tab-link").length>0&&jQuery(document).on("click",".food-menu-page-filter-tab-link",WPFM_Frontend.actions.smoothScrolling)},actions:{removeFoodItem:function(e){jQuery(this).parents("li").remove()},addElementRow:function(e){var t=0;t=jQuery(this).parents("table").find("tbody tr").length,t+=1;var o=jQuery(this).closest(".postbox").children(".repeated-options").val(),r=jQuery(this).data("row").replace(/%%repeated-option-index3%%/g,t).replace(/%%repeated-option-index2%%/g,o);r.replace('value="1"',t),jQuery(this).parents("table").find("tbody").append(r)},removeAttributesOptions:function(e){var t=jQuery(this).closest(".postbox").children(".repeated-options").val();jQuery(".wpfm-options-box-"+t+" tbody tr.option-tr-"+jQuery(this).data("id")).remove()},removeAttributes:function(e){jQuery(".wpfm-options-box-"+jQuery(this).data("id")).remove()},updateOptionTitle:function(e){jQuery(this).closest(".postbox").children("h3").children(".attribute_name").text(this.value);var t=this.value.replace(/\s/g,"_").toLowerCase();jQuery(this).closest(".postbox").children("h3").children(".attribute_key").children("input").val(t),""==this.value&&(jQuery(this).closest(".postbox").children("h3").children(".attribute_name").text("Option Key"),jQuery(this).closest(".postbox").children("h3").children(".attribute_key").children("input").val("topping_key"))},addNewOption:function(e){var t=0;jQuery(".wpfm-form-wrapper").find("div.wpfm-options-wrap").length&&jQuery(".wpfm-form-wrapper").find("div.wpfm-options-wrap").each((function(){t++})),t+=1;var o=jQuery(this).data("row").replace(/__repeated-option-index__/g,t).replace(/%repeated-option-index%/g,t);jQuery(".wpfm-form-wrapper .wpfm-actions").before(o),jQuery(".container .wpfm-form-wrapper table.widefat tbody").sortable({connectWith:".container .wpfm-form-wrapper table.widefat tbody",items:"tr",axis:"y",placeholder:"placeholder",opacity:.65,update:function(e,t){var o=jQuery(this).closest(".postbox").children(".repeated-options").val();jQuery(".container .wpfm-form-group.fieldset_topping_options_"+o+" table.widefat tbody tr").each((function(e){var t=e+1;jQuery(this).children("td:nth-child(2)").html(t),jQuery(this).attr("class","option-tr-"+t),jQuery(this).children(".option-value-class").val(t),jQuery(this).children("td").children(".opt_name").attr("name",o+"_option_name_"+t),jQuery(this).children("td").children(".opt_price").attr("name",o+"_option_price_"+t),jQuery(this).children("td").children(".option-delete-btn").attr("data-id",t)}))}}).disableSelection(),jQuery('input[data-picker="datepicker"]').length>0&&(wpfm_food_submission.show_past_date?jQuery('input[data-picker="datepicker"]').datepicker({dateFormat:wpfm_food_submission.i18n_datepicker_format,firstDay:wpfm_food_submission.start_of_week,monthNames:wpfm_food_submission.monthNames}):jQuery('input[data-picker="datepicker"]').datepicker({minDate:0,dateFormat:wpfm_food_submission.i18n_datepicker_format,firstDay:wpfm_food_submission.start_of_week,monthNames:wpfm_food_submission.monthNames})),jQuery(".food-manager-multiselect").chosen({search_contains:!0});jQuery(this).parents(".wpfm-options-wrapper").children(".wpfm-options-wrap").length;fieldLabel=jQuery(this).parents(".wpfm-options-wrapper").children(".wpfm-options-wrap").find("fieldset.wpfm-form-group.wp-editor-field").last().attr("data-field-name");var r=fieldLabel;wp.editor.initialize(r,{tinymce:{wpautop:!1,textarea_rows:8,plugins:"lists,paste,tabfocus,wplink,wordpress",toolbar1:"bold,italic,|,bullist,numlist,|,link,unlink,|,undo,redo",toolbar2:"",paste_as_text:!0,paste_auto_cleanup_on_paste:!0,paste_remove_spans:!0,paste_remove_styles:!0,paste_remove_styles_if_webkit:!0,paste_strip_class_attributes:!0},quicktags:!1,mediaButtons:!1})},smoothScrolling:function(e){e.preventDefault();var t=jQuery(this.getAttribute("href"));t.length&&jQuery("html, body").stop().animate({scrollTop:t.offset().top-50},1e3)},openFoodMenuPopup:function(e){e.preventDefault();var t=jQuery(this);t.prop("disabled",!0);var o=this,r=jQuery(this).closest(".food-list-box").attr("data-id"),i=jQuery(this).closest(".food-list-box").find(".add_to_cart_button").attr("data-product_id"),n=jQuery(this).closest(".food-list-box").find("#quantity_"+i).val();jQuery.ajax({url:wpfm_frontend.ajax_url,method:"POST",data:{action:"food_manager_get_food_popup",food_id:r,product_id:i,quantity:n},success:function(e){jQuery(o).parents(".wpfm-single-food-menu-page").next(".wpfm-modal.wpfm-food-popup").html(e.html),jQuery(o).parents(".wpfm-single-food-menu-page").next(".wpfm-modal.wpfm-food-popup").addClass("wpfm-modal-open"),t.prop("disabled",!1)},error:function(e,o,r){console.error(r),t.prop("disabled",!1)}})}}}};WPFM_Frontend=WPFM_Frontend(),jQuery(document).ready((function(e){WPFM_Frontend.init()}));