var WPFM_Frontend=function(){return{init:function(){jQuery(".food-manager-post_type-dropdown").length>0&&jQuery(".food-manager-post_type-dropdown").chosen({search_contains:!0}),jQuery(".wpfm-additional-main-row").length>0&&(jQuery(".wpfm-additional-main-row").hide(),jQuery(".wpfm-view-more").click(function(){jQuery(this).text("View less -"==jQuery(this).text()?"View more +":"View less -"),jQuery(this).parent().find(".wpfm-additional-main-row").slideToggle()})),jQuery(".wpfm-form-group.fieldset-topping_description").hide(),jQuery("body").on("click","a.wpfm-food-item-remove",WPFM_Frontend.actions.removeFoodItem),jQuery("body").on("wpfm_add_error_tip",function(t,e,o){var i=e.position();0===e.parent().find(".wpfm_error_tip").length&&(e.after('<div class="wpfm_error_tip '+o+'">'+wpfm_accounting_params[o]+"</div>"),e.parent().find(".wpfm_error_tip").css("left",i.left+e.width()-e.width()/2-jQuery(".wpfm_error_tip").width()/2).css("top",i.top+e.height()).fadeIn("100"))}),jQuery("body").on("wpfm_remove_error_tip",function(t,e,o){e.parent().find(".wpfm_error_tip."+o).fadeOut("100",function(){jQuery(this).remove()})}),jQuery("body").on("click",function(){jQuery(".wpfm_error_tip").fadeOut("100",function(){jQuery(this).remove()})}),jQuery("body").on("blur","#_food_sale_price",function(){jQuery(".wpfm_error_tip").fadeOut("100",function(){jQuery(this).remove()})}),jQuery("body").on("keyup","#_food_sale_price",function(t,e){var o,i=jQuery(this);o=jQuery("#_food_price");var r=parseFloat(window.accounting.unformat(i.val())),n=parseFloat(window.accounting.unformat(o.val()));r>=n?jQuery(document.body).triggerHandler("wpfm_add_error_tip",[jQuery(this),"wpfm_sale_less_than_regular_error"]):jQuery(document.body).triggerHandler("wpfm_remove_error_tip",[jQuery(this),"wpfm_sale_less_than_regular_error"])}),jQuery("body").on("change","#_food_sale_price",function(){var t,e=jQuery(this);t=jQuery("#_food_price");var o=parseFloat(window.accounting.unformat(e.val())),i=parseFloat(window.accounting.unformat(t.val()));o>=i&&jQuery(this).val("")}),jQuery(document).on("click",".wpfm-add-row",WPFM_Frontend.actions.addElementRow),jQuery(document).on("click",".option-delete-btn",WPFM_Frontend.actions.removeAttributesOptions),jQuery(document).on("click",".wpfm-delete-btn",WPFM_Frontend.actions.removeAttributes),jQuery("#wpfm-add-new-option").on("click",WPFM_Frontend.actions.addNewOption),jQuery("body").on("change",'input[name^="topping_name"]',WPFM_Frontend.actions.updateOptionTitle),jQuery(document).on("click",".wpfm-togglediv",function(t){var e=jQuery(this).data("row-count");"true"===jQuery(t.currentTarget).attr("aria-expanded")?(jQuery(".wpfm-options-wrap.wpfm-options-box-"+e).removeClass("closed"),jQuery(this).attr("aria-expanded","false")):(jQuery(".wpfm-options-wrap.wpfm-options-box-"+e).addClass("closed"),jQuery(this).attr("aria-expanded","true")),jQuery(this).parents(".postbox").find(".wpfm-options-box").slideToggle("slow")}),jQuery(".container .wpfm-form-wrapper table.widefat tbody").sortable({connectWith:".container .wpfm-form-wrapper table.widefat tbody",items:"tr",axis:"y",helper:function(t,e){return e.children().children().each(function(){jQuery(this).width(jQuery(this).width())}),e},placeholder:"placeholder",opacity:.65,update:function(t,e){var o=jQuery(this).closest(".postbox").children(".repeated-options").val();jQuery(".container .wpfm-form-group.fieldset_topping_options_"+o+" table.widefat tbody tr").each(function(t){var e=t+1;jQuery(this).children("td:nth-child(2)").html(e),jQuery(this).attr("class","option-tr-"+e),jQuery(this).children(".option-value-class").val(e),jQuery(this).children("td").children(".opt_name").attr("name",o+"_option_name_"+e),jQuery(this).children("td").children(".opt_price").attr("name",o+"_option_price_"+e),jQuery(this).children("td").children(".option-delete-btn").attr("data-id",e)})}}).disableSelection(),jQuery("body").on("wpfm_add_error_tip",function(t,e,o){var i=e.position();0===e.parent().find(".wpfm_error_tip").length&&(e.after('<div class="wpfm_error_tip '+o+'">'+wpfm_accounting_params[o]+"</div>"),e.parent().find(".wpfm_error_tip").css("left",i.left+e.width()-e.width()/2-jQuery(".wpfm_error_tip").width()/2).css("top",i.top+e.height()).fadeIn("100"))}),jQuery("body").on("wpfm_remove_error_tip",function(t,e,o){e.parent().find(".wpfm_error_tip."+o).fadeOut("100",function(){jQuery(this).remove()})}),jQuery("body").on("click",function(){jQuery(".wpfm_error_tip").fadeOut("100",function(){jQuery(this).remove()})}),jQuery("body").on("blur","#food_sale_price",function(){jQuery(".wpfm_error_tip").fadeOut("100",function(){jQuery(this).remove()})}),jQuery("body").on("keyup","#food_sale_price",function(t,e){var o,i=jQuery(this);o=jQuery("#food_price");var r=parseFloat(window.accounting.unformat(i.val())),n=parseFloat(window.accounting.unformat(o.val()));r>=n?jQuery(document.body).triggerHandler("wpfm_add_error_tip",[jQuery(this),"wpfm_sale_less_than_regular_error"]):jQuery(document.body).triggerHandler("wpfm_remove_error_tip",[jQuery(this),"wpfm_sale_less_than_regular_error"])}),jQuery("body").on("change","#food_sale_price",function(){var t,e=jQuery(this);t=jQuery("#food_price");var o=parseFloat(window.accounting.unformat(e.val())),i=parseFloat(window.accounting.unformat(t.val()));o>=i&&jQuery(this).val("")})},actions:{removeFoodItem:function(t){jQuery(this).parents("li").remove()},addElementRow:function(t){var e=0;e=jQuery(this).parents("table").find("tbody tr").length,e+=1;var o=jQuery(this).closest(".postbox").children(".repeated-options").val(),i=jQuery(this).data("row").replace(/%%repeated-option-index3%%/g,e).replace(/%%repeated-option-index2%%/g,o);i.replace('value="1"',e),jQuery(this).parents("table").find("tbody").append(i)},removeAttributesOptions:function(t){var e=jQuery(this).closest(".postbox").children(".repeated-options").val();jQuery(".wpfm-options-box-"+e+" tbody tr.option-tr-"+jQuery(this).data("id")).remove()},removeAttributes:function(t){jQuery(".wpfm-options-box-"+jQuery(this).data("id")).remove()},updateOptionTitle:function(t){jQuery(this).closest(".postbox").children("h3").children(".attribute_name").text(this.value);var e=this.value.replace(/\s/g,"_").toLowerCase();jQuery(this).closest(".postbox").children("h3").children(".attribute_key").children("input").val(e),""==this.value&&(jQuery(this).closest(".postbox").children("h3").children(".attribute_name").text("Option Key"),jQuery(this).closest(".postbox").children("h3").children(".attribute_key").children("input").val("topping_key"))},addNewOption:function(t){var e=0;jQuery(".wpfm-form-wrapper").find("div.wpfm-options-wrap").length&&jQuery(".wpfm-form-wrapper").find("div.wpfm-options-wrap").each(function(){e++}),e+=1;var o=jQuery(this).data("row").replace(/__repeated-option-index__/g,e).replace(/%repeated-option-index%/g,e);jQuery(".wpfm-form-wrapper .wpfm-actions").before(o),jQuery(".container .wpfm-form-wrapper table.widefat tbody").sortable({connectWith:".container .wpfm-form-wrapper table.widefat tbody",items:"tr",axis:"y",helper:function(t,e){return e.children().children().each(function(){jQuery(this).width(jQuery(this).width())}),e},placeholder:"placeholder",opacity:.65,update:function(t,e){var o=jQuery(this).closest(".postbox").children(".repeated-options").val();jQuery(".container .wpfm-form-group.fieldset_topping_options_"+o+" table.widefat tbody tr").each(function(t){var e=t+1;jQuery(this).children("td:nth-child(2)").html(e),jQuery(this).attr("class","option-tr-"+e),jQuery(this).children(".option-value-class").val(e),jQuery(this).children("td").children(".opt_name").attr("name",o+"_option_name_"+e),jQuery(this).children("td").children(".opt_price").attr("name",o+"_option_price_"+e),jQuery(this).children("td").children(".option-delete-btn").attr("data-id",e)})}}).disableSelection(),jQuery('input[data-picker="datepicker"]').length>0&&(wpfm_food_submission.show_past_date?jQuery('input[data-picker="datepicker"]').datepicker({dateFormat:wpfm_food_submission.i18n_datepicker_format,firstDay:wpfm_food_submission.start_of_week,monthNames:wpfm_food_submission.monthNames}):jQuery('input[data-picker="datepicker"]').datepicker({minDate:0,dateFormat:wpfm_food_submission.i18n_datepicker_format,firstDay:wpfm_food_submission.start_of_week,monthNames:wpfm_food_submission.monthNames})),jQuery(".food-manager-multiselect").chosen({search_contains:!0}),jQuery(this).parents(".wpfm-options-wrapper").children(".wpfm-options-wrap").length;var i=fieldLabel=jQuery(this).parents(".wpfm-options-wrapper").children(".wpfm-options-wrap").find("fieldset.wpfm-form-group.wp-editor-field").last().attr("data-field-name");wp.editor.initialize(i,{tinymce:{wpautop:!1,textarea_rows:8,plugins:"lists,paste,tabfocus,wplink,wordpress",toolbar1:"bold,italic,|,bullist,numlist,|,link,unlink,|,undo,redo",toolbar2:"",paste_as_text:!0,paste_auto_cleanup_on_paste:!0,paste_remove_spans:!0,paste_remove_styles:!0,paste_remove_styles_if_webkit:!0,paste_strip_class_attributes:!0},quicktags:!1,mediaButtons:!1})}}}};WPFM_Frontend=WPFM_Frontend(),jQuery(document).ready(function(t){WPFM_Frontend.init()});